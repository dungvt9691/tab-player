function convertModelSong2UGPSong(E){var c={};c.tempo=120;c.subtempo=1;c.meter=32;c.riffs=[];c.positions=[];c.loopStart=null;c.loopEnd=null;for(var ai=0;ai<E.measureHeaders.length;ai++){var f=E.measureHeaders[ai];var X={};X.measureHeader=f;X.id=""+ai;X.left=ai;X.top=0;X.riffIds=[];var C=f.timeSignature.numerator*(32/f.timeSignature.denominator.value);X.length=C;X.tempo=f.tempo.value;X.number=f.number;X.startInMilliSeconds=f.startInMilliSeconds;X.start=f.start;c.positions.push(X)}c.samples=[];c.channels=[];var h={};c.samples.push(h);h.signed=[];h.midi=1000;h.volume=1;h.isDrum=true;h.path=predefinedMIDIDrums[h.midi];h.id=30000+h.midi;var W={riffs:[],pan:0.5,volume:0.5,midi:-1,mute:true};c.channels.push(W);for(var ai=0;ai<E.tracks.length;ai++){var D=E.tracks[ai];W={riffs:[]};c.channels.push(W);var Z=D.offset;var I=D.channel.balance;if(!isNaN(I)){W.pan=I/127}else{W.pan=0.5}var U=D.channel.volume;if(U){W.volume=U/127}else{W.volume=0.99}if(D.isPercussionTrack&&D.channel._instrument==0){W.midi=-1;for(var ag=0;ag<D.measures.length;ag++){var o=D.measures[ag];var aj=0;if(o.header.tripletFeel){aj=4;if(o.header.tripletFeel==2){aj=2}}var y={};y.measure=o;c.riffs.push(y);W.riffs.push(y);y.id=""+((ai+1)*1000+ag);y.tunes=[];y.beat=[];var X=c.positions[ag];X.riffIds.push(y.id);for(var al=0;al<o.beats.length;al++){var T=o.beats[al];var B=Math.floor((T.start-o.header.start)/120);var N=(T.start-o.header.start)/120-B;for(var ah=y.beat.length;ah<=B;ah++){y.beat[ah]=[]}for(var aa=0;aa<T.voices.length;aa++){var Y=T.voices[aa];var K=voiceDuration(Y);if(Y.notes.length>0){for(var ak=0;ak<Y.notes.length;ak++){var F=Y.notes[ak];if(F.isTiedNote){}else{var S={};y.beat[B].push(S);var P=null;for(var ad=0;ad<c.samples.length;ad++){if(c.samples[ad].isDrum&&c.samples[ad].midi==F.value){P=c.samples[ad].id}}if(P==null){var x={};c.samples.push(x);x.signed=[];x.midi=F.value;x.isDrum=true;x.path=predefinedMIDIDrums[F.value];x.id=2000+F.value;P=x.id}S.sampleId=P;S.timeCorrection=N;S.velocity=F.velocity;if(aj){if(K==aj){if(B/(aj*2)==Math.round(B/(aj*2))){}else{if((aj+B)/(aj*2)==Math.round((aj+B)/(aj*2))){S.timeCorrection=S.timeCorrection+aj*0.3}}}}}}}}}}}else{W.midi=D.channel._instrument;var x={};c.samples.push(x);W.sample=x;x.signed=[];x.midi=D.channel._instrument;x.isDrum=false;x.path=predefinedMIDIInstruments[x.midi];x.id=ai;var L=[];for(var ac=0;ac<D.strings.length;ac++){var t={};L.push(t);t.number=D.strings[ac].number;t.value=D.strings[ac].value}var e=[];var q=-1;var G=-1;var Q=-1;var af=null;for(var ag=0;ag<D.measures.length;ag++){var o=D.measures[ag];var aj=0;if(o.header.tripletFeel){aj=4;if(o.header.tripletFeel==2){aj=2}}var y={};y.measure=o;c.riffs.push(y);W.riffs.push(y);y.id=((ai+1)*1000+ag);y.tunes=[];y.beat=[];var X=c.positions[ag];X.riffIds.push(y.id);var d={};y.tunes.push(d);d.steps=[];d.sampleId=x.id;for(var al=0;al<o.beats.length;al++){var T=o.beats[al];var B=Math.floor((T.start-o.header.start)/120);var N=(T.start-o.header.start)/120-B;for(var ah=d.steps.length;ah<=B;ah++){d.steps[ah]=[]}var R=d.steps[B];for(var aa=0;aa<T.voices.length;aa++){var Y=T.voices[aa];if(Y.notes.length>0){var K=voiceDuration(Y);for(var ak=0;ak<Y.notes.length;ak++){var F=Y.notes[ak];var ae=0;for(var l=0;l<L.length;l++){if(L[l].number==F.string){ae=L[l].value+F.value;break}}var O=null;for(var w=0;w<e.length;w++){if(e[w].noteString==F.string&&e[w].noteValue==F.value){O=e[w];break}}if(F.isTiedNote&&(!(F.effect.grace))){if(O){e[w].length=O.length+K}}else{if(F.isTiedNote){if(O){e[w].length=O.length+K}}var S={};S.stepStart=B;if(O){if(O.letRing){}}S.noteString=F.string;S.noteValue=F.value;S.beatEffectTremoloPickingDurationValue=0;S.pitch=ae+Z;S.length=K;S.tripletFeelShift=0;if(F.effect.staccato){S.length=Math.round((32/Y.duration.value)/2);if(S.length<1){S.length=1}}if(T.effect.tapping){}if(T.effect.fadeIn){S.fadeIn=true}if(F.effect.tremoloPicking){S.beatEffectTremoloPickingDurationValue=F.effect.tremoloPicking.duration.value}if(T.effect.pickStroke){S.pickStroke=T.effect.pickStroke}if(F.effect.letRing){S.letRing=true}if(F.effect.trill){S.trillSize=F.effect.trill.fret-F.value;S.trillValue=F.effect.trill.duration.value}S.shift=0;S.velocity=F.velocity;if(F.effect.heavyAccentuatedNote){S.heavyAccentuatedNote=true;S.velocity=3*S.velocity}if(F.effect.accentuatedNote){S.accentuatedNote=true;S.velocity=1.5*S.velocity}if(F.effect.deadNote){S.deadNote=true}if(F.effect.ghostNote){S.velocity=0.5*S.velocity}if(F.effect.hammer){if(Q==F.string){S.velocity=0.5*S.velocity}Q=F.string}else{Q=-1}if(F.effect.vibrato){S.vibrato=F.effect.vibrato}if(F.effect.slide){q=F.string;G=F.value;af=S}else{if(q>-1){if(q==F.string){if(af){af.slideTo=ae+Z;q=-1;af=null}}}}if(F.effect.bend){S.bends=[];for(var H=0;H<F.effect.bend.points.length;H++){S.bends.push({position:F.effect.bend.points[H].position,pitch:F.effect.bend.points[H].value})}S.bends.type=F.effect.bend.type;S.bends.value=F.effect.bend.value}if(F.effect.isHarmonic){if(F.effect.isHarmonic()){if(F.effect.harmonic.data){S.harmonic=true;S.harmonicType=F.effect.harmonic.type;S.harmonicData=F.effect.harmonic.data;if(F.harmonicOvertone){S.harmonicOvertone=F.harmonicOvertone()}else{S.harmonicOvertone=0}var g=S.pitch+S.harmonicOvertone;if(S.harmonicType==0){if(S.noteValue==5){S.pitch=S.pitch-5+12+12+12}else{if(S.noteValue==7){S.pitch=S.pitch-7+12+7}else{S.pitch=g}}}else{S.pitch=g;S.velocity=0.5*S.velocity}}}}if(F.effect.palmMute){S.palmMute=true}if(T.effect.slapping){S.slapping=true}if(T.effect.popping){S.popping=true}if(F.effect.grace){var z=S;z.length=z.length-1;if(d.steps[B+1]){}else{d.steps[B+1]=[]}var M=d.steps[B+1];M.push(z);S={shift:0,length:1,pitch:z.pitch,velocity:z.velocity*0.7}}var J=true;for(var w=0;w<e.length;w++){if(e[w].noteString==S.noteString&&e[w].noteValue==S.noteValue){e[w]=S;J=false;break}}if(J){e.push(S)}S.timeCorrection=N;if(aj){if(K==aj){if(B/(aj*2)==Math.round(B/(aj*2))){S.length=S.length*4/3}else{if((aj+B)/(aj*2)==Math.round((aj+B)/(aj*2))){S.timeCorrection=S.timeCorrection+aj*0.3;S.length=S.length*2/3}}}}R.push(S)}}}}if(T.effect.pickStroke){if(T.effect.pickStroke>1){T.effect.stroke.direction=1}else{T.effect.stroke.direction=-1}}if(T.effect.stroke.direction!=0){R.sort(function(m,k){return T.effect.stroke.direction*(m.pitch-k.pitch)});for(var A=0;A<R.length;A++){R[A].strokeOrder=A+1}}}}}}var u=[];var a=-1;var j=false;loopCounter=0;var ak=0;for(var ai=0;ai<E.measureHeaders.length;ai++){var f=E.measureHeaders[ai];var ab="";if(f.isRepeatOpen){ab=ab+"<"}if(f.repeatClose){ab=ab+"["+f.repeatClose+"]"}if(f.repeatAlternative){ab=ab+" /"+f.repeatAlternative.toString(2)}}for(var ai=0;ai<E.measureHeaders.length;ai++){if(ak>999){break}ak++;var f=E.measureHeaders[ai];if(a<0&&(!(f.isRepeatOpen))){u.push(c.positions[ai])}else{var V=validMask(f.repeatAlternative,loopCounter);if(f.isRepeatOpen){if(a<0){loopCounter=1;a=ai}else{if(a<ai){if(j){j=false;a=ai;loopCounter=0}else{j=true}V=false;ai=a-1}else{loopCounter++}}}if(V){u.push(c.positions[ai]);if(f.repeatClose>0){f.jumpCounter=incrementInit(f.jumpCounter);if(f.repeatClose>f.jumpCounter){ai=a-1}}}else{if(f.repeatClose>0){f.jumpCounter=incrementInit(f.jumpCounter);if(f.repeatClose>=f.jumpCounter){a=-1}}}}}for(var ai=0;ai<u.length;ai++){var X={};X.id=""+ai;X.left=ai;X.top=0;X.riffIds=u[ai].riffIds;X.length=u[ai].length;X.measureHeader=u[ai].measureHeader;X.tempo=u[ai].tempo;X.number=u[ai].number;X.startInMilliSeconds=u[ai].startInMilliSeconds;X.start=u[ai].start;u[ai]=X}c.positions=u;addAlternativeSamples(c);calculateLetRing(c);return c}function dumpHeader(c,b){var a="";if(b.isRepeatOpen){a=a+"<<<<<<<<<<<<<<<"}if(b.repeatClose){a=a+"   >"+b.repeatClose+""}if(b.repeatAlternative){a=a+" ("+b.repeatAlternative.toString(2)+")"}console.log("--",c,a,b.number)}function calculateLetRing(x){var h=[];var v=0;for(var b=0;b<x.positions.length;b++){var k=x.positions[b];for(var a=0;a<k.riffIds.length;a++){var o=k.riffIds[a];for(var m=0;m<x.riffs.length;m++){if(x.riffs[m].id==o){var c=x.riffs[m];for(var u=0;u<c.tunes.length;u++){var l=c.tunes[u];for(var w=0;w<l.steps.length;w++){var e=l.steps[w];for(var d=0;d<e.length;d++){var q=e[d];if(q.letRing){q.startLetRing=v+w;q.openLetRing=true;h.push(q)}for(var j=0;j<h.length;j++){var g=h[h.length-j-1];if(g.noteString==q.noteString&&g.openLetRing&&g.startLetRing<q.startLetRing){g.length=v+w-g.startLetRing;g.openLetRing=false;break}}}}}break}}}for(var j=0;j<h.length;j++){var g=h[h.length-j-1];if(g.openLetRing){g.openLetRing=false;g.length=k.length-g.stepStart+1}}v=v+k.length}}function existsInstrumentByMIDI(a,c){for(var b=0;b<a.samples.length;b++){if((!a.samples[b].isDrum)&&a.samples[b].midi==c){return true}}return false}function addAlternativeSampleFor(b,c,d){if(existsInstrumentByMIDI(b,c)){if(!existsInstrumentByMIDI(b,d)){var a={};b.samples.push(a);a.signed=[];a.midi=d;a.isDrum=false;a.path=predefinedMIDIInstruments[d];a.id=Math.random()}}}function addAlternativeSamples(a){addAlternativeSampleFor(a,24,28);addAlternativeSampleFor(a,25,28);addAlternativeSampleFor(a,26,28);addAlternativeSampleFor(a,27,28);addAlternativeSampleFor(a,28,28);addAlternativeSampleFor(a,32,28);addAlternativeSampleFor(a,33,28);addAlternativeSampleFor(a,34,28);addAlternativeSampleFor(a,35,28);addAlternativeSampleFor(a,36,28);addAlternativeSampleFor(a,37,28);addAlternativeSampleFor(a,24,1001);addAlternativeSampleFor(a,25,1001);addAlternativeSampleFor(a,26,1001);addAlternativeSampleFor(a,27,1001);addAlternativeSampleFor(a,28,1001);addAlternativeSampleFor(a,29,31);addAlternativeSampleFor(a,30,31);addAlternativeSampleFor(a,29,1002);addAlternativeSampleFor(a,30,1002);addAlternativeSampleFor(a,32,36);addAlternativeSampleFor(a,33,36);addAlternativeSampleFor(a,34,36);addAlternativeSampleFor(a,35,36);addAlternativeSampleFor(a,32,37);addAlternativeSampleFor(a,33,37);addAlternativeSampleFor(a,34,37);addAlternativeSampleFor(a,35,37)}function addSongMIDISample(b,d){var a=null;for(var c=0;c<b.samples.length;c++){if((!b.samples[c].isDrum)&&b.samples[c].midi==d){a=b.samples[c]}}if(a==null){a={};b.samples.push(a);a.signed=[];a.midi=d;a.isDrum=false;a.path=predefinedMIDIInstruments[d];a.id=Math.random()}}function alternativeMIDIpoint(j,b,g,h,f){var e=null;for(var a=0;a<j.samples.length;a++){if((!j.samples[a].isDrum)&&j.samples[a].midi==f){e=j.samples[a]}}if(e==null){e={};j.samples.push(e);e.signed=[];e.midi=f;e.isDrum=false;e.path=predefinedMIDIInstruments[f];e.id=Math.random()}var c=null;for(var a=0;a<b.tunes.length;a++){if(b.tunes[a].sampleId==e.id){c=b.tunes[a]}}if(c==null){c={};b.tunes.push(c);c.steps=[];c.sampleId=e.id}if(!(c.steps[h])){c.steps[h]=[]}var d=c.steps[h];d.push(g)}function incrementInit(a){var b;if(a>0){b=a+1}else{b=1}return b}function validMask(c,b){valid=true;if(c>0){var a=Math.pow(2,b-1);valid=(c&a)==a}return valid}function tupletDelay(d,f){if(f.duration.tuplet,f.duration.value){if(f.duration.tuplet.times>1||f.duration.tuplet.enters>1){var a=f.duration.tuplet.times*32/f.duration.value;var e=d%a;var c=1;var b=2;if(f.duration.value==8){c=2;b=5}if(f.duration.value==4){c=4;b=11}if(e==c){return a/3-e}if(e==b){return 2*a/3-e}return 0}}return 0}function voiceDuration(b){var a=32/b.duration.value;if(b.duration.isDotted){a=a+(32/b.duration.value)/2}if(b.duration.isDoubleDotted){a=a+(32/b.duration.value)/4}if(b.duration.tuplet){a=a*b.duration.tuplet.times/b.duration.tuplet.enters}return a}function startLoadRawSamples(b){for(var a=0;a<b.samples.length;a++){if(b.samples[a].signed.length<1){if(b.samples[a].path){startLoadSample(b.samples[a],b);break}}}}function startLoadSample(b,a){console.log("load sample",b.path);var c=new XMLHttpRequest();c.open("GET",b.path,true);c.responseType="arraybuffer";c.onload=function(){if(c.readyState==4){var e=c.response;var d=new DataView(e);for(i=0;i<d.byteLength;i++){b.signed.push(d.getInt8(i))}adjustSample(b);startLoadRawSamples(a)}else{console.log("part")}};c.onerror=function(d){console.log("error",d);b.signed.push(0);startLoadRawSamples(a)};c.send()}adjustSample=function(c){try{var j=c.path.split("/");var h=j[j.length-1];var g=h.split("_");var a=g[1].split("-");c.pitchStart=1*(a[0]);c.pitchEnd=1*a[1];var b=g[4].split("-");if(b[0]<10){c.loopStart=0;c.loopEnd=0}else{c.loopStart=1*b[0];c.loopEnd=1*b[1]}c.basePitch=1*g[2];c.correction=1*g[3];c.sampleRate=1*g[5];if(c.path.indexOf("/drums/")>-1){c.isDrum=true}else{c.isDrum=false}if(c.isDrum){var d=g[1].split("-");c.midi=1*d[0];c.correction=-4000;if(c.path.indexOf("SynthGMS_128")>-1){c.sampleRate=22050}}else{c.midi=1*j[j.length-3]}}catch(f){console.log("adjustSample error: ",f,c)}};var predefinedMIDIDrums=[];predefinedMIDIDrums[35]="http://molgav.nn.ru/sf/drums/000/Chaos_128/001_035-035_60_-3500.0_8-16861_44100";predefinedMIDIDrums[36]="http://molgav.nn.ru/sf/drums/000/Chaos_128/002_036-036_60_-3600.0_8-6995_44100";predefinedMIDIDrums[37]="http://molgav.nn.ru/sf/drums/000/Chaos_128/003_037-037_60_-3700.0_8-3119_44100";predefinedMIDIDrums[38]="http://molgav.nn.ru/sf/drums/000/Chaos_128/004_038-038_60_-3800.0_8-17828_44100";predefinedMIDIDrums[39]="http://molgav.nn.ru/sf/drums/000/Chaos_128/005_039-039_60_-3900.0_8-25353_44100";predefinedMIDIDrums[40]="http://molgav.nn.ru/sf/drums/000/Chaos_128/006_040-040_60_-4000.0_8-14339_44100";predefinedMIDIDrums[41]="http://molgav.nn.ru/sf/drums/000/Chaos_128/007_041-041_60_-4100.0_8-48590_44100";predefinedMIDIDrums[42]="http://molgav.nn.ru/sf/drums/000/Chaos_128/059_042-042_60_-4200.0_8-6826_32000";predefinedMIDIDrums[43]="http://molgav.nn.ru/sf/drums/000/Chaos_128/008_043-043_60_-4300.0_8-48513_44100";predefinedMIDIDrums[44]="http://molgav.nn.ru/sf/drums/000/Chaos_128/060_044-044_60_-4400.0_8-2902_32000";predefinedMIDIDrums[45]="http://molgav.nn.ru/sf/drums/000/Chaos_128/010_045-045_60_-4500.0_8-50870_44100";predefinedMIDIDrums[46]="http://molgav.nn.ru/sf/drums/000/Chaos_128/061_046-046_60_-4600.0_8-34789_32000";predefinedMIDIDrums[47]="http://molgav.nn.ru/sf/drums/000/Chaos_128/011_047-047_60_-4700.0_8-48791_44100";predefinedMIDIDrums[48]="http://molgav.nn.ru/sf/drums/000/Chaos_128/012_048-048_60_-4800.0_8-37915_44100";predefinedMIDIDrums[49]="http://molgav.nn.ru/sf/drums/000/Chaos_128/014_049-049_60_-4900.0_8-120623_44100";predefinedMIDIDrums[50]="http://molgav.nn.ru/sf/drums/000/Chaos_128/013_050-050_60_-5000.0_8-30531_44100";predefinedMIDIDrums[51]="http://molgav.nn.ru/sf/drums/000/Chaos_128/015_051-051_60_-5100.0_8-93910_44100";predefinedMIDIDrums[52]="http://molgav.nn.ru/sf/drums/000/Chaos_128/016_052-052_60_-5200.0_8-77493_44100";predefinedMIDIDrums[53]="http://molgav.nn.ru/sf/drums/000/Chaos_128/017_053-053_60_-5300.0_8-99849_44100";predefinedMIDIDrums[54]="http://molgav.nn.ru/sf/drums/000/Chaos_128/019_054-054_60_-5400.0_8-8179_44100";predefinedMIDIDrums[55]="http://molgav.nn.ru/sf/drums/000/Chaos_128/020_055-055_60_-5500.0_8-57261_44100";predefinedMIDIDrums[56]="http://molgav.nn.ru/sf/drums/000/Chaos_128/021_056-056_60_-5600.0_8-2866_44100";predefinedMIDIDrums[57]="http://molgav.nn.ru/sf/drums/000/Chaos_128/022_057-057_60_-5700.0_8-109440_44100";predefinedMIDIDrums[58]="http://molgav.nn.ru/sf/drums/000/Chaos_128/023_058-058_60_-5800.0_8-66841_44100";predefinedMIDIDrums[59]="http://molgav.nn.ru/sf/drums/000/Chaos_128/024_059-059_60_-5900.0_8-90666_44100";predefinedMIDIDrums[60]="http://molgav.nn.ru/sf/drums/000/Chaos_128/025_060-060_60_-6000.0_8-3020_44100";predefinedMIDIDrums[61]="http://molgav.nn.ru/sf/drums/000/Chaos_128/026_061-061_60_-6100.0_8-4917_44100";predefinedMIDIDrums[62]="http://molgav.nn.ru/sf/drums/000/Chaos_128/027_062-062_60_-6200.0_8-7274_44100";predefinedMIDIDrums[63]="http://molgav.nn.ru/sf/drums/000/Chaos_128/028_063-063_60_-6300.0_8-6940_44100";predefinedMIDIDrums[64]="http://molgav.nn.ru/sf/drums/000/Chaos_128/030_064-064_60_-6400.0_8-25349_44100";predefinedMIDIDrums[65]="http://molgav.nn.ru/sf/drums/000/Chaos_128/031_065-065_60_-6500.0_8-21672_44100";predefinedMIDIDrums[66]="http://molgav.nn.ru/sf/drums/000/Chaos_128/032_066-066_60_-6600.0_8-30857_44100";predefinedMIDIDrums[67]="http://molgav.nn.ru/sf/drums/000/Chaos_128/033_067-067_60_-6700.0_8-4512_44100";predefinedMIDIDrums[68]="http://molgav.nn.ru/sf/drums/000/Chaos_128/034_068-068_60_-6800.0_8-5408_44100";predefinedMIDIDrums[69]="http://molgav.nn.ru/sf/drums/000/Chaos_128/035_069-069_60_-6900.0_8-7852_44100";predefinedMIDIDrums[70]="http://molgav.nn.ru/sf/drums/000/Chaos_128/036_070-070_60_-7000.0_8-1849_44100";predefinedMIDIDrums[71]="http://molgav.nn.ru/sf/drums/000/Chaos_128/037_071-071_60_-7100.0_8-3692_44100";predefinedMIDIDrums[72]="http://molgav.nn.ru/sf/drums/000/Chaos_128/038_072-072_60_-7200.0_8-15619_44100";predefinedMIDIDrums[73]="http://molgav.nn.ru/sf/drums/000/Chaos_128/039_073-073_60_-7300.0_8-2056_44100";predefinedMIDIDrums[74]="http://molgav.nn.ru/sf/drums/000/Chaos_128/041_074-074_60_-7400.0_8-13008_44100";predefinedMIDIDrums[75]="http://molgav.nn.ru/sf/drums/000/Chaos_128/058_075-075_60_-7500.0_8-2504_44100";predefinedMIDIDrums[76]="http://molgav.nn.ru/sf/drums/000/Chaos_128/042_076-076_60_-7600.0_8-4570_44100";predefinedMIDIDrums[77]="http://molgav.nn.ru/sf/drums/000/Chaos_128/043_077-077_60_-7700.0_8-4798_44100";predefinedMIDIDrums[78]="http://molgav.nn.ru/sf/drums/000/Chaos_128/044_078-078_60_-7800.0_8-9155_44100";predefinedMIDIDrums[79]="http://molgav.nn.ru/sf/drums/000/Chaos_128/045_079-079_60_-7900.0_8-12519_44100";predefinedMIDIDrums[80]="http://molgav.nn.ru/sf/drums/000/Chaos_128/046_080-080_60_-8000.0_8-7291_44100";predefinedMIDIDrums[81]="http://molgav.nn.ru/sf/drums/000/Chaos_128/047_081-081_60_-8100.0_8-55282_44100";predefinedMIDIDrums[81]="http://molgav.nn.ru/sf/drums/000/Chaos_128/047_081-081_60_-8100.0_8-55282_44100";var predefinedMIDIInstruments=[];predefinedMIDIInstruments[0]="http://molgav.nn.ru/sf/instruments/000/Chaos_000/003_048-052_60_-5000_8-32231_22050";predefinedMIDIInstruments[1]="http://molgav.nn.ru/sf/instruments/001/Chaos_000/004_053-057_60_-5500_8-57105_44100";predefinedMIDIInstruments[2]="http://molgav.nn.ru/sf/instruments/002/Chaos_000/042_047-050_60_-6100_498-656_44100";predefinedMIDIInstruments[3]="http://molgav.nn.ru/sf/instruments/003/Chaos_000/003_048-052_60_-5000_8-32231_22050";predefinedMIDIInstruments[4]="http://molgav.nn.ru/sf/instruments/004/Chaos_000/000_000-064_60_-7000_1143-1238_44100";predefinedMIDIInstruments[5]="http://molgav.nn.ru/sf/instruments/005/Chaos_000/000_000-066_60_-6800_2183-2288_44100";predefinedMIDIInstruments[6]="http://molgav.nn.ru/sf/instruments/006/Chaos_000/001_048-055_60_-6400_508-645_44100";predefinedMIDIInstruments[7]="http://molgav.nn.ru/sf/instruments/007/Chaos_000/002_049-055_60_-6000_824-991_44100";predefinedMIDIInstruments[8]="http://molgav.nn.ru/sf/instruments/008/Chaos_000/000_000-096_60_-9100_4273-4440_44100";predefinedMIDIInstruments[9]="http://molgav.nn.ru/sf/instruments/009/Chaos_000/000_000-098_60_-9400_5624-6074_44100";predefinedMIDIInstruments[10]="http://molgav.nn.ru/sf/instruments/010/Chaos_000/000_000-096_60_-8900_2774-3053_44100";predefinedMIDIInstruments[11]="http://molgav.nn.ru/sf/instruments/011/Chaos_000/000_000-069_60_-7500_860-929_44100";predefinedMIDIInstruments[12]="http://molgav.nn.ru/sf/instruments/012/Chaos_000/000_000-054_60_-5800_1252-1437_44100";predefinedMIDIInstruments[13]="http://molgav.nn.ru/sf/instruments/013/Chaos_000/000_000-098_60_-7900_889-944_44100";predefinedMIDIInstruments[14]="http://molgav.nn.ru/sf/instruments/014/Chaos_000/000_000-108_60_-8600_4818-5471_44100";predefinedMIDIInstruments[15]="http://molgav.nn.ru/sf/instruments/015/Chaos_000/000_000-088_60_-7900_3194-3250_44100";predefinedMIDIInstruments[16]="http://molgav.nn.ru/sf/instruments/016/Chaos_000/000_000-054_60_-6800_50-262_44100";predefinedMIDIInstruments[17]="http://molgav.nn.ru/sf/instruments/017/Chaos_000/000_000-080_60_-7800_1350-1472_44100";predefinedMIDIInstruments[18]="http://molgav.nn.ru/sf/instruments/018/Chaos_000/002_044-055_60_-6700_8-41545_22050";predefinedMIDIInstruments[19]="http://molgav.nn.ru/sf/instruments/019/Fluid_000/000_000-036_36_-3600_24522-61248_22050";predefinedMIDIInstruments[20]="http://molgav.nn.ru/sf/instruments/020/Chaos_000/001_053-070_60_-7800_727-787_44100";predefinedMIDIInstruments[21]="http://molgav.nn.ru/sf/instruments/021/Chaos_000/001_053-070_60_-7800_727-787_44100";predefinedMIDIInstruments[22]="http://molgav.nn.ru/sf/instruments/022/Chaos_000/002_060-064_60_-7400_1023-1097_44100";predefinedMIDIInstruments[23]="http://molgav.nn.ru/sf/instruments/023/Chaos_000/001_053-070_60_-7800_727-787_44100";predefinedMIDIInstruments[24]="http://molgav.nn.ru/sf/instruments/024/Chaos_000/004_063-065_60_-7400_2109-2184_44100";predefinedMIDIInstruments[25]="http://molgav.nn.ru/sf/instruments/025/Chaos_000/002_055-063_60_-5900_8-71799_22050";predefinedMIDIInstruments[26]="http://molgav.nn.ru/sf/instruments/026/Chaos_000/001_045-049_60_-5600_5451-5664_44100";predefinedMIDIInstruments[27]="http://molgav.nn.ru/sf/instruments/027/Chaos_000/002_060-063_60_-7200_1554-1639_44100";predefinedMIDIInstruments[28]="http://molgav.nn.ru/sf/instruments/028/Chaos_000/002_055-127_60_-6000_8-1508_22050";predefinedMIDIInstruments[29]="http://molgav.nn.ru/sf/instruments/030/Kamac_000/005_050-051_60_-5000_15291-16040_22050";predefinedMIDIInstruments[30]="http://molgav.nn.ru/sf/instruments/030/Kamac_000/001_040-042_60_-4000_17910-18177_22050";predefinedMIDIInstruments[31]="http://molgav.nn.ru/sf/instruments/031/Chaos_000/000_068-127_60_-6800_1085-1350_44100";predefinedMIDIInstruments[32]="http://molgav.nn.ru/sf/instruments/032/Fluid_000/000_000-028_60_-2800_76560-78701_44100";predefinedMIDIInstruments[33]="http://molgav.nn.ru/sf/instruments/033/SynthGMS_000/000_000-084_60_-6200_750-900_44100";predefinedMIDIInstruments[34]="http://molgav.nn.ru/sf/instruments/034/Chaos_000/002_044-052_60_-4500_8655-9466_44100";predefinedMIDIInstruments[35]="http://molgav.nn.ru/sf/instruments/035/Chaos_000/001_050-127_60_-5600_17100-17523_44100";predefinedMIDIInstruments[36]="http://molgav.nn.ru/sf/instruments/036/Chaos_000/001_038-127_60_-4300_8-25976_44100";predefinedMIDIInstruments[37]="http://molgav.nn.ru/sf/instruments/037/Chaos_000/001_038-127_60_-4300_8-25976_44100";predefinedMIDIInstruments[38]="http://molgav.nn.ru/sf/instruments/038/Chaos_000/004_060-065_60_-6400_1995-2129_44100";predefinedMIDIInstruments[39]="http://molgav.nn.ru/sf/instruments/039/Chaos_000/003_057-127_60_-5000_8-6721_22050";predefinedMIDIInstruments[40]="http://molgav.nn.ru/sf/instruments/040/Chaos_000/001_061-066_60_-7400_1510-1585_44100";predefinedMIDIInstruments[41]="http://molgav.nn.ru/sf/instruments/041/Chaos_000/001_059-065_60_-7400_1510-1585_44100";predefinedMIDIInstruments[42]="http://molgav.nn.ru/sf/instruments/042/Chaos_000/000_061-073_60_-5800_1325-1514_44100";predefinedMIDIInstruments[43]="http://molgav.nn.ru/sf/instruments/043/Chaos_000/000_060-073_60_-5400_5223-5461_44100";predefinedMIDIInstruments[44]="http://molgav.nn.ru/sf/instruments/044/Chaos_000/002_058-063_60_-7000_5314-24115_44100";predefinedMIDIInstruments[45]="http://molgav.nn.ru/sf/instruments/045/Chaos_000/000_000-068_60_-7500_3506-3577_44100";predefinedMIDIInstruments[46]="http://molgav.nn.ru/sf/instruments/046/Chaos_000/001_049-051_60_-7700_529-592_44100";predefinedMIDIInstruments[47]="http://molgav.nn.ru/sf/instruments/047/Chaos_000/001_045-127_60_-4800_8-26756_22050";predefinedMIDIInstruments[48]="http://molgav.nn.ru/sf/instruments/048/Chaos_000/002_058-063_60_-7000_5314-24115_44100";predefinedMIDIInstruments[49]="http://molgav.nn.ru/sf/instruments/049/Chaos_000/001_050-057_60_-6500_12249-26224_44100";predefinedMIDIInstruments[50]="http://molgav.nn.ru/sf/instruments/050/Chaos_000/000_000-061_60_-6700_18-11263_44100";predefinedMIDIInstruments[51]="http://molgav.nn.ru/sf/instruments/051/Chaos_000/004_000-061_60_-6700_18-11263_44100";predefinedMIDIInstruments[52]="http://molgav.nn.ru/sf/instruments/052/Chaos_000/001_055-066_60_-6000_8-22252_22050";predefinedMIDIInstruments[53]="http://molgav.nn.ru/sf/instruments/053/Chaos_000/002_057-061_60_-6700_1-4470_44100";predefinedMIDIInstruments[54]="http://molgav.nn.ru/sf/instruments/054/Chaos_000/000_000-074_60_-7600_3-9947_44100";predefinedMIDIInstruments[55]="http://molgav.nn.ru/sf/instruments/055/Chaos_000/001_000-127_60_-8800_8-34778_44100";predefinedMIDIInstruments[56]="http://molgav.nn.ru/sf/instruments/056/Fluid_000/000_000-066_60_-6000_7185-18296_44100";predefinedMIDIInstruments[57]="http://molgav.nn.ru/sf/instruments/057/Chaos_000/001_055-059_60_-6800_2440-2544_44100";predefinedMIDIInstruments[58]="http://molgav.nn.ru/sf/instruments/058/Chaos_000/002_042-046_60_-5600_18971-25008_44100";predefinedMIDIInstruments[59]="http://molgav.nn.ru/sf/instruments/059/Chaos_000/000_000-062_60_-6800_2460-2566_44100";predefinedMIDIInstruments[60]="http://molgav.nn.ru/sf/instruments/060/Chaos_000/000_000-067_60_-7400_3338-3414_44100";predefinedMIDIInstruments[61]="http://molgav.nn.ru/sf/instruments/061/Chaos_000/000_000-065_60_-7100_8434-28133_44100";predefinedMIDIInstruments[62]="http://molgav.nn.ru/sf/instruments/062/Chaos_000/000_000-068_60_-6600_19-10715_44100";predefinedMIDIInstruments[63]="http://molgav.nn.ru/sf/instruments/063/Chaos_000/000_000-067_60_-6600_19-10715_44100";predefinedMIDIInstruments[64]="http://molgav.nn.ru/sf/instruments/064/Chaos_000/002_063-066_60_-7200_44934-52491_44100";predefinedMIDIInstruments[65]="http://molgav.nn.ru/sf/instruments/065/Chaos_000/000_000-055_60_-4800_8-22996_22050";predefinedMIDIInstruments[66]="http://molgav.nn.ru/sf/instruments/066/Fluid_000/000_000-047_60_-4700_52484-59757_32000";predefinedMIDIInstruments[67]="http://molgav.nn.ru/sf/instruments/067/Chaos_000/003_049-052_60_-6200_1222-1372_44100";predefinedMIDIInstruments[68]="http://molgav.nn.ru/sf/instruments/068/Chaos_000/000_000-062_60_-6900_3336-3437_44100";predefinedMIDIInstruments[69]="http://molgav.nn.ru/sf/instruments/069/Chaos_000/001_055-058_60_-6800_1026-1130_44100";predefinedMIDIInstruments[70]="http://molgav.nn.ru/sf/instruments/070/Chaos_000/002_051-054_60_-6300_893-1034_44100";predefinedMIDIInstruments[71]="http://molgav.nn.ru/sf/instruments/071/Chaos_000/001_050-055_60_-5700_1891-2094_44100";predefinedMIDIInstruments[72]="http://molgav.nn.ru/sf/instruments/072/Chaos_000/000_000-088_60_-9000_782-811_44100";predefinedMIDIInstruments[73]="http://molgav.nn.ru/sf/instruments/073/Chaos_000/000_000-070_60_-7700_1418-1480_44100";predefinedMIDIInstruments[74]="http://molgav.nn.ru/sf/instruments/074/Chaos_000/000_000-096_60_-8000_1683-1736_44100";predefinedMIDIInstruments[75]="http://molgav.nn.ru/sf/instruments/075/Chaos_000/000_053-076_60_-7700_1570-8382_44100";predefinedMIDIInstruments[76]="http://molgav.nn.ru/sf/instruments/076/Chaos_000/000_000-100_60_-7700_4207-10523_44100";predefinedMIDIInstruments[77]="http://molgav.nn.ru/sf/instruments/077/Chaos_000/000_000-108_60_-8900_3174-3206_44100";predefinedMIDIInstruments[78]="http://molgav.nn.ru/sf/instruments/078/Chaos_000/000_000-108_60_-8800_156-190_44100";predefinedMIDIInstruments[79]="http://molgav.nn.ru/sf/instruments/079/Chaos_000/000_000-108_60_-8800_156-190_44100";predefinedMIDIInstruments[80]="http://molgav.nn.ru/sf/instruments/080/Chaos_000/000_000-064_60_-6900_8-14597_32000";predefinedMIDIInstruments[81]="http://molgav.nn.ru/sf/instruments/081/Chaos_000/000_000-068_60_-6700_8-13481_32000";predefinedMIDIInstruments[82]="http://molgav.nn.ru/sf/instruments/082/Chaos_000/001_051-062_60_-7100_16118-44026_44100";predefinedMIDIInstruments[83]="http://molgav.nn.ru/sf/instruments/083/Chaos_000/000_000-076_60_-7700_1570-8382_44100";predefinedMIDIInstruments[84]="http://molgav.nn.ru/sf/instruments/084/Chaos_000/004_053-057_60_-5500_8-96417_22050";predefinedMIDIInstruments[85]="http://molgav.nn.ru/sf/instruments/085/Chaos_000/000_000-108_60_-9800_129-5427_44100";predefinedMIDIInstruments[86]="http://molgav.nn.ru/sf/instruments/086/Chaos_000/000_000-091_60_-8400_4609-13118_44100";predefinedMIDIInstruments[87]="http://molgav.nn.ru/sf/instruments/087/Chaos_000/002_055-065_60_-6400_1995-2129_44100";predefinedMIDIInstruments[88]="http://molgav.nn.ru/sf/instruments/088/Chaos_000/002_000-078_60_-8400_4609-13118_44100";predefinedMIDIInstruments[89]="http://molgav.nn.ru/sf/instruments/089/Chaos_000/000_000-084_60_-8400_4609-13118_44100";predefinedMIDIInstruments[90]="http://molgav.nn.ru/sf/instruments/090/Chaos_000/000_000-091_60_-8400_4609-13118_44100";predefinedMIDIInstruments[91]="http://molgav.nn.ru/sf/instruments/091/Chaos_000/000_000-108_60_-9500_26-4870_44100";predefinedMIDIInstruments[92]="http://molgav.nn.ru/sf/instruments/092/Chaos_000/000_000-108_60_-9500_26-4870_44100";predefinedMIDIInstruments[93]="http://molgav.nn.ru/sf/instruments/093/Chaos_000/002_060-063_60_-7200_1554-1639_44100";predefinedMIDIInstruments[94]="http://molgav.nn.ru/sf/instruments/094/Chaos_000/000_000-090_60_-7600_3-9947_44100";predefinedMIDIInstruments[95]="http://molgav.nn.ru/sf/instruments/095/Chaos_000/000_000-091_60_-8400_4609-13118_44100";predefinedMIDIInstruments[96]="http://molgav.nn.ru/sf/instruments/096/Chaos_000/000_000-091_60_-8400_4609-13118_44100";predefinedMIDIInstruments[97]="http://molgav.nn.ru/sf/instruments/097/Chaos_000/000_000-084_60_-7700_4609-13118_44100";predefinedMIDIInstruments[98]="http://molgav.nn.ru/sf/instruments/098/Chaos_000/000_000-084_60_-9100_4273-4440_44100";predefinedMIDIInstruments[99]="http://molgav.nn.ru/sf/instruments/099/Chaos_000/000_000-091_60_-8400_4609-13118_44100";predefinedMIDIInstruments[100]="http://molgav.nn.ru/sf/instruments/100/Chaos_000/000_000-108_60_-9800_129-5427_44100";predefinedMIDIInstruments[101]="http://molgav.nn.ru/sf/instruments/101/Chaos_000/000_000-090_60_-7600_3-9947_44100";predefinedMIDIInstruments[102]="http://molgav.nn.ru/sf/instruments/102/Chaos_000/001_068-073_60_-8100_4-6974_44100";predefinedMIDIInstruments[103]="http://molgav.nn.ru/sf/instruments/103/Chaos_000/001_048-059_60_-6400_1530-1665_44100";predefinedMIDIInstruments[104]="http://molgav.nn.ru/sf/instruments/104/Chaos_000/000_000-084_60_-7400_1488-1562_44100";predefinedMIDIInstruments[105]="http://molgav.nn.ru/sf/instruments/105/Chaos_000/000_000-063_60_-6900_2095-2196_44100";predefinedMIDIInstruments[106]="http://molgav.nn.ru/sf/instruments/106/Chaos_000/001_056-060_60_-7000_1102-1197_44100";predefinedMIDIInstruments[107]="http://molgav.nn.ru/sf/instruments/107/Chaos_000/001_062-066_60_-7300_1016-1094_44100";predefinedMIDIInstruments[108]="http://molgav.nn.ru/sf/instruments/108/Chaos_000/000_000-084_60_-7200_2024-2192_44100";predefinedMIDIInstruments[109]="http://molgav.nn.ru/sf/instruments/109/Chaos_000/001_058-084_60_-7900_976-1033_44100";predefinedMIDIInstruments[110]="http://molgav.nn.ru/sf/instruments/110/Chaos_000/000_000-060_60_-7000_1205-1299_44100";predefinedMIDIInstruments[111]="http://molgav.nn.ru/sf/instruments/111/Chaos_000/001_055-056_60_-6800_1026-1130_44100";predefinedMIDIInstruments[112]="http://molgav.nn.ru/sf/instruments/112/Chaos_000/000_000-127_60_-10700_3438-4116_44100";predefinedMIDIInstruments[113]="http://molgav.nn.ru/sf/instruments/113/Chaos_000/000_000-108_60_-8400_2123-2289_44100";predefinedMIDIInstruments[114]="http://molgav.nn.ru/sf/instruments/114/Chaos_000/000_000-089_60_-7600_4661-4791_44100";predefinedMIDIInstruments[115]="http://molgav.nn.ru/sf/instruments/115/Chaos_000/000_000-127_60_-9200_3-844_44100";predefinedMIDIInstruments[116]="http://molgav.nn.ru/sf/instruments/116/Chaos_000/000_000-108_60_-8200_1799-3399_44100";predefinedMIDIInstruments[117]="http://molgav.nn.ru/sf/instruments/117/Chaos_000/000_000-127_60_-6000_8-25332_44100";predefinedMIDIInstruments[118]="http://molgav.nn.ru/sf/instruments/118/Chaos_000/000_000-108_60_-10300_1230-1313_44100";predefinedMIDIInstruments[119]="http://molgav.nn.ru/sf/instruments/119/Chaos_000/000_000-127_60_-6000_3807-12024_44100";predefinedMIDIInstruments[120]="http://molgav.nn.ru/sf/instruments/120/Chaos_000/000_000-108_60_-7500_3-3409_44100";predefinedMIDIInstruments[121]="http://molgav.nn.ru/sf/instruments/121/Chaos_000/000_000-076_60_-7700_1570-8382_44100";predefinedMIDIInstruments[122]="http://molgav.nn.ru/sf/instruments/122/Chaos_000/000_000-108_60_-8300_6-14020_44100";predefinedMIDIInstruments[123]="http://molgav.nn.ru/sf/instruments/123/Chaos_000/000_000-127_60_-6000_8-62283_44100";predefinedMIDIInstruments[124]="http://molgav.nn.ru/sf/instruments/124/Chaos_000/000_000-127_68_-6755_32-1537_22050";predefinedMIDIInstruments[125]="http://molgav.nn.ru/sf/instruments/125/Chaos_000/000_000-108_60_-8800_3-4157_44100";predefinedMIDIInstruments[126]="http://molgav.nn.ru/sf/instruments/126/Chaos_000/000_000-127_60_-8500_9-8682_44100";predefinedMIDIInstruments[127]="http://molgav.nn.ru/sf/instruments/127/Chaos_000/000_000-108_60_-8200_3-10413_44100";var MIDIdrumNames=[];MIDIdrumNames[35]="Bass Drum 2";MIDIdrumNames[36]="Bass Drum 1";MIDIdrumNames[37]="Side Stick/Rimshot";MIDIdrumNames[38]="Snare Drum 1";MIDIdrumNames[39]="Hand Clap";MIDIdrumNames[40]="Snare Drum 2";MIDIdrumNames[41]="Low Tom 2";MIDIdrumNames[42]="Closed Hi-hat";MIDIdrumNames[43]="Low Tom 1";MIDIdrumNames[44]="Pedal Hi-hat";MIDIdrumNames[45]="Mid Tom 2";MIDIdrumNames[46]="Open Hi-hat";MIDIdrumNames[47]="Mid Tom 1";MIDIdrumNames[48]="High Tom 2";MIDIdrumNames[49]="Crash Cymbal 1";MIDIdrumNames[50]="High Tom 1";MIDIdrumNames[51]="Ride Cymbal 1";MIDIdrumNames[52]="Chinese Cymbal";MIDIdrumNames[53]="Ride Bell";MIDIdrumNames[54]="Tambourine";MIDIdrumNames[55]="Splash Cymbal";MIDIdrumNames[56]="Cowbell";MIDIdrumNames[57]="Crash Cymbal 2";MIDIdrumNames[58]="Vibra Slap";MIDIdrumNames[59]="Ride Cymbal 2";MIDIdrumNames[60]="High Bongo";MIDIdrumNames[61]="Low Bongo";MIDIdrumNames[62]="Mute High Conga";MIDIdrumNames[63]="Open High Conga";MIDIdrumNames[64]="Low Conga";MIDIdrumNames[65]="High Timbale";MIDIdrumNames[66]="Low Timbale";MIDIdrumNames[67]="High Agogo";MIDIdrumNames[68]="Low Agogo";MIDIdrumNames[69]="Cabasa";MIDIdrumNames[70]="Maracas";MIDIdrumNames[71]="Short Whistle";MIDIdrumNames[72]="Long Whistle";MIDIdrumNames[73]="Short Guiro";MIDIdrumNames[74]="Long Guiro";MIDIdrumNames[75]="Claves";MIDIdrumNames[76]="High Wood Block";MIDIdrumNames[77]="Low Wood Block";MIDIdrumNames[78]="Mute Cuica";MIDIdrumNames[79]="Open Cuica";MIDIdrumNames[80]="Mute Triangle";MIDIdrumNames[81]="Open Triangle";var MIDIinsNames=[];MIDIinsNames[0]="Acoustic Grand Piano: Piano";MIDIinsNames[1]="Bright Acoustic Piano: Piano";MIDIinsNames[2]="Electric Grand Piano: Piano";MIDIinsNames[3]="Honky-tonk Piano: Piano";MIDIinsNames[4]="Electric Piano 1: Piano";MIDIinsNames[5]="Electric Piano 2: Piano";MIDIinsNames[6]="Harpsichord: Piano";MIDIinsNames[7]="Clavinet: Piano";MIDIinsNames[8]="Celesta: Chromatic Percussion";MIDIinsNames[9]="Glockenspiel: Chromatic Percussion";MIDIinsNames[10]="Music Box: Chromatic Percussion";MIDIinsNames[11]="Vibraphone: Chromatic Percussion";MIDIinsNames[12]="Marimba: Chromatic Percussion";MIDIinsNames[13]="Xylophone: Chromatic Percussion";MIDIinsNames[14]="Tubular Bells: Chromatic Percussion";MIDIinsNames[15]="Dulcimer: Chromatic Percussion";MIDIinsNames[16]="Drawbar Organ: Organ";MIDIinsNames[17]="Percussive Organ: Organ";MIDIinsNames[18]="Rock Organ: Organ";MIDIinsNames[19]="Church Organ: Organ";MIDIinsNames[20]="Reed Organ: Organ";MIDIinsNames[21]="Accordion: Organ";MIDIinsNames[22]="Harmonica: Organ";MIDIinsNames[23]="Tango Accordion: Organ";MIDIinsNames[24]="Acoustic Guitar (nylon): Guitar";MIDIinsNames[25]="Acoustic Guitar (steel): Guitar";MIDIinsNames[26]="Electric Guitar (jazz): Guitar";MIDIinsNames[27]="Electric Guitar (clean): Guitar";MIDIinsNames[28]="Electric Guitar (muted): Guitar";MIDIinsNames[29]="Overdriven Guitar: Guitar";MIDIinsNames[30]="Distortion Guitar: Guitar";MIDIinsNames[31]="Guitar Harmonics: Guitar";MIDIinsNames[32]="Acoustic Bass: Bass";MIDIinsNames[33]="Electric Bass (finger): Bass";MIDIinsNames[34]="Electric Bass (pick): Bass";MIDIinsNames[35]="Fretless Bass: Bass";MIDIinsNames[36]="Slap Bass 1: Bass";MIDIinsNames[37]="Slap Bass 2: Bass";MIDIinsNames[38]="Synth Bass 1: Bass";MIDIinsNames[39]="Synth Bass 2: Bass";MIDIinsNames[40]="Violin: Strings";MIDIinsNames[41]="Viola: Strings";MIDIinsNames[42]="Cello: Strings";MIDIinsNames[43]="Contrabass: Strings";MIDIinsNames[44]="Tremolo Strings: Strings";MIDIinsNames[45]="Pizzicato Strings: Strings";MIDIinsNames[46]="Orchestral Harp: Strings";MIDIinsNames[47]="Timpani: Strings";MIDIinsNames[48]="String Ensemble 1: Ensemble";MIDIinsNames[49]="String Ensemble 2: Ensemble";MIDIinsNames[50]="Synth Strings 1: Ensemble";MIDIinsNames[51]="Synth Strings 2: Ensemble";MIDIinsNames[52]="Choir Aahs: Ensemble";MIDIinsNames[53]="Voice Oohs: Ensemble";MIDIinsNames[54]="Synth Choir: Ensemble";MIDIinsNames[55]="Orchestra Hit: Ensemble";MIDIinsNames[56]="Trumpet: Brass";MIDIinsNames[57]="Trombone: Brass";MIDIinsNames[58]="Tuba: Brass";MIDIinsNames[59]="Muted Trumpet: Brass";MIDIinsNames[60]="French Horn: Brass";MIDIinsNames[61]="Brass Section: Brass";MIDIinsNames[62]="Synth Brass 1: Brass";MIDIinsNames[63]="Synth Brass 2: Brass";MIDIinsNames[64]="Soprano Sax: Reed";MIDIinsNames[65]="Alto Sax: Reed";MIDIinsNames[66]="Tenor Sax: Reed";MIDIinsNames[67]="Baritone Sax: Reed";MIDIinsNames[68]="Oboe: Reed";MIDIinsNames[69]="English Horn: Reed";MIDIinsNames[70]="Bassoon: Reed";MIDIinsNames[71]="Clarinet: Reed";MIDIinsNames[72]="Piccolo: Pipe";MIDIinsNames[73]="Flute: Pipe";MIDIinsNames[74]="Recorder: Pipe";MIDIinsNames[75]="Pan Flute: Pipe";MIDIinsNames[76]="Blown bottle: Pipe";MIDIinsNames[77]="Shakuhachi: Pipe";MIDIinsNames[78]="Whistle: Pipe";MIDIinsNames[79]="Ocarina: Pipe";MIDIinsNames[80]="Lead 1 (square): Synth Lead";MIDIinsNames[81]="Lead 2 (sawtooth): Synth Lead";MIDIinsNames[82]="Lead 3 (calliope): Synth Lead";MIDIinsNames[83]="Lead 4 (chiff): Synth Lead";MIDIinsNames[84]="Lead 5 (charang): Synth Lead";MIDIinsNames[85]="Lead 6 (voice): Synth Lead";MIDIinsNames[86]="Lead 7 (fifths): Synth Lead";MIDIinsNames[87]="Lead 8 (bass + lead): Synth Lead";MIDIinsNames[88]="Pad 1 (new age): Synth Pad";MIDIinsNames[89]="Pad 2 (warm): Synth Pad";MIDIinsNames[90]="Pad 3 (polysynth): Synth Pad";MIDIinsNames[91]="Pad 4 (choir): Synth Pad";MIDIinsNames[92]="Pad 5 (bowed): Synth Pad";MIDIinsNames[93]="Pad 6 (metallic): Synth Pad";MIDIinsNames[94]="Pad 7 (halo): Synth Pad";MIDIinsNames[95]="Pad 8 (sweep): Synth Pad";MIDIinsNames[96]="FX 1 (rain): Synth Effects";MIDIinsNames[97]="FX 2 (soundtrack): Synth Effects";MIDIinsNames[98]="FX 3 (crystal): Synth Effects";MIDIinsNames[99]="FX 4 (atmosphere): Synth Effects";MIDIinsNames[100]="FX 5 (brightness): Synth Effects";MIDIinsNames[101]="FX 6 (goblins): Synth Effects";MIDIinsNames[102]="FX 7 (echoes): Synth Effects";MIDIinsNames[103]="FX 8 (sci-fi): Synth Effects";MIDIinsNames[104]="Sitar: Ethnic";MIDIinsNames[105]="Banjo: Ethnic";MIDIinsNames[106]="Shamisen: Ethnic";MIDIinsNames[107]="Koto: Ethnic";MIDIinsNames[108]="Kalimba: Ethnic";MIDIinsNames[109]="Bagpipe: Ethnic";MIDIinsNames[110]="Fiddle: Ethnic";MIDIinsNames[111]="Shanai: Ethnic";MIDIinsNames[112]="Tinkle Bell: Percussive";MIDIinsNames[113]="Agogo: Percussive";MIDIinsNames[114]="Steel Drums: Percussive";MIDIinsNames[115]="Woodblock: Percussive";MIDIinsNames[116]="Taiko Drum: Percussive";MIDIinsNames[117]="Melodic Tom: Percussive";MIDIinsNames[118]="Synth Drum: Percussive";MIDIinsNames[119]="Reverse Cymbal: Percussive";MIDIinsNames[120]="Guitar Fret Noise: Sound effects";MIDIinsNames[121]="Breath Noise: Sound effects";MIDIinsNames[122]="Seashore: Sound effects";MIDIinsNames[123]="Bird Tweet: Sound effects";MIDIinsNames[124]="Telephone Ring: Sound effects";MIDIinsNames[125]="Helicopter: Sound effects";MIDIinsNames[126]="Applause: Sound effects";MIDIinsNames[127]="Gunshot: Sound effects";function findDrumSample(c,b){for(var a=0;a<samplesForDrums.length;a++){if(samplesForDrums[a].midi==c&&samplesForDrums[a].velRangeLow<=b&&samplesForDrums[a].velRangeHigh>=b){return samplesForDrums[a]}}return null}function findInstrumentSample(d,c,b){for(var a=0;a<samplesForInstruments.length;a++){if(samplesForInstruments[a].midi==d&&samplesForInstruments[a].velRangeLow<=c&&samplesForInstruments[a].velRangeHigh>=c&&samplesForInstruments[a].keyRangeLow<=b&&samplesForInstruments[a].keyRangeHigh>=b){return samplesForInstruments[a]}}return null}function readLENum(a,e,d){var c=a[e];for(var b=e+1;b<e+d;b++){c=c+a[b]*256}return c}function ______safeName(a){a=a.replace(/\s/g,"_");a=a.replace("&","%26");a=a.replace("+","%2B");a=a.replace("%","%25");a=a.replace("#","%23");return a}function attachAllSongSamples(a,c,b){console.log("attachAllSongSamples from",c,c.samples);attachSongSamplesFrom(a,c,0,b)}function attachSongSamplesFrom(c,e,f,d){for(var b=f;b<e.samples.length;b++){var a=e.samples[b];if(a.isDrum){attachMIDIDrum(a.midi,c,e.samples.length,b+1,function(){attachSongSamplesFrom(c,e,f+1,d)});return}else{attachMIDIInstrument(a.midi,c,e.samples.length,b+1,function(){attachSongSamplesFrom(c,e,f+1,d)});return}}d()}function attachMIDIInstrument(c,a,b,d,e){attachMIDISamples(c,samplesForInstruments,a,b,d,e)}function attachMIDIDrum(c,a,b,d,e){attachMIDISamples(c,samplesForDrums,a,b,d,e)}function attachMIDISamples(e,h,b,d,f,g){for(var a=0;a<h.length;a++){var c=h[a];if(c.cached){}else{if(c.midi==e){attachSampleRaw(c,b,d,f,function(){attachMIDISamples(e,h,b,d,f,g)});return}}}g()}function attachSampleRaw(d,b,c,g,h){if(b.notify){b.notify(8,""+c+":"+g+":"+(1/c))}var f=soundFontBase+safeName(d.sample.trim())+".wav";for(var a=0;a<rawSamplesData.length;a++){if(rawSamplesData[a].sample.trim()==d.sample.trim()){console.log("skip",f);d.integers=rawSamplesData[a].integer;d.copy=rawSamplesData[a];d.cached=rawSamplesData[a].cached;d.sampleRate=rawSamplesData[a].sampleRate;h();return}}var e=new XMLHttpRequest();e.open("GET",f,true);e.responseType="arraybuffer";e.onload=function(){if(e.readyState==4){var n=e.response;var l=new DataView(n);var t=[];for(m=0;m<l.byteLength;m++){t.push(l.getUint8(m))}d.sampleRate=readLENum(t,0+24,2);var q=t.length;var k=[];var j=0;for(var m=0;m<t.length-4&&m<1234;m++){if(t[m+0]==100&&t[m+1]==97&&t[m+2]==116&&t[m+3]==97){j=m+8}}for(var m=j;m<t.length;m=m+2){var o=readLENum(t,m,2);if(o>128*256-1){o=o-256*256}k.push(o)}d.integers=k;d.cached=true;var r={sample:d.sample.trim(),integers:k,cached:true,sampleRate:d.sampleRate};rawSamplesData.push(r);console.log("loaded",f);ugpAudioContext.decodeAudioData(n,function(s){r.audioBuffer=s;d.audioBuffer=s},function(s){});h()}};e.onerror=function(j){console.log("error "+j)};e.send()}function fillIntegersFromCache(b){for(var a=0;a<rawSamplesData.length;a++){if(rawSamplesData[a].sample.trim()==b.sample.trim()){b.integers=rawSamplesData[a].integers;return}}}var rawSamplesData=[];var paths=[];var soundFontBase="http://tptestutils.wsmgroup.ru/soundfont/v1/";var safe=true;function stripSoundFont(){console.log("stripSoundFont");var a=new XMLHttpRequest();a.open("GET",soundFontBase+"soundfont.xml",true);a.onload=function(){if(a.readyState==4){var e=a.response;var c=new ValueTree();c.fromXMLstring(e);console.log("tree",c);var d=c.of("soundfont").of("presets").all("preset");paths=[];var b=[];var f=c.of("soundfont").of("drumBank").value;var g=c.of("soundfont").of("drumId").value;p=findPreset(d,f,g);fillInstruments(-1,b,p,c);attachInstrument(paths,b,c,function(){var j=[];for(var h=0;h<128;h++){p=findPreset(d,"0",""+h);fillInstruments(h,j,p,c)}attachInstrument(paths,j,c,function(){extractSamplePaths(c,paths)})})}};a.onerror=function(b){console.log("error "+b)};a.send()}function extractSamplePaths(a,c){console.log("var samplesForDrums=[{}");for(var b=0;b<c.length;b++){if(c[b].isDrum){console.log(",{","midi:",c[b].midiKey,', sample:"',c[b].sampleName,'", originalPitch:',c[b].originalPitch,", velRangeLow:",c[b].velRangeLow,", velRangeHigh:",c[b].velRangeHigh,", coarseTune:",c[b].coarseTune,", fineTune:",c[b].fineTune,"}")}}console.log("];");console.log("var samplesForInstruments=[{}");for(var b=0;b<c.length;b++){if(!c[b].isDrum){console.log(",{","midi:",c[b].midiKey,', sample:"',c[b].sampleName,'", originalPitch:',c[b].originalPitch,", velRangeLow:",c[b].velRangeLow,", velRangeHigh:",c[b].velRangeHigh,", keyRangeLow:",c[b].keyRangeLow,", keyRangeHigh:",c[b].keyRangeHigh,", loopStart:",c[b].loopStart,", loopEnd:",c[b].loopEnd,", coarseTune:",c[b].coarseTune,", fineTune:",c[b].fineTune,"}")}}console.log("];")}function attachInstrument(j,a,g,b){var c=a[0];var h=findInstrument(c.instrumentID,g);var e=safeName(h.of("name").value);var k=soundFontBase+e+"/"+e+".xml";var d=new XMLHttpRequest();d.open("GET",k,true);d.onload=function(){if(d.readyState==4){var l=d.response;var f=new ValueTree();f.fromXMLstring(l);h.of("description").children=f.of("instrument").children;readPaths(j,c.midi,g,f.of("instrument"),h);if(a.length>1){attachInstrument(j,a.slice(1),g,b)}else{b()}}};d.onerror=function(f){console.log("error "+f)};d.send()}function readPaths(q,b,v,a,x){var e=1*a.of("defaultSetts").of("coarseTune").value;var g=1*a.of("defaultSetts").of("fineTune").value;var j=a.of("zones").all("zone");for(var u=0;u<j.length;u++){var d=j[u];var c=d.of("sampleRecord").of("sampleId").value;var s=findSample(c,a);var w=b;var f=false;if(b<0){w=d.of("keyRange").of("low").value*1;f=true}var h=1*d.of("coarseTune").value;if(h==0){h=e}var t=1*d.of("fineTune").value;if(t==0){t=g}var l={isDrum:f,midiKey:w,keyRangeLow:1*d.of("keyRange").of("low").value,keyRangeHigh:1*d.of("keyRange").of("high").value,velRangeLow:1*d.of("velRange").of("low").value,velRangeHigh:1*d.of("velRange").of("high").value,sampleName:x.of("name").value+"/"+s.of("name").value,originalPitch:1*s.of("originalPitch").value,loopStart:1*d.of("sampleRecord").of("loopStart").value,loopEnd:1*d.of("sampleRecord").of("loopEnd").value,coarseTune:h,fineTune:t};var o=false;for(var r=l.keyRangeLow;r<=l.keyRangeHigh;r++){for(var m=0;m<q.length;m++){if(l.midiKey==q[m].midiKey&&l.isDrum==q[m].isDrum&&r>=q[m].keyRangeLow&&r<=q[m].keyRangeHigh&&l.velRangeLow>=q[m].velRangeLow&&l.velRangeHigh<=q[m].velRangeHigh){o=true;break}}if(o){break}}if(!o){if(l.isDrum&&(l.midiKey<34||l.midiKey>81)){console.log("wrong drum midi",l.midiKey)}else{if((!l.isDrum)&&(l.midiKey<0||l.midiKey>127)){console.log("wrong instrument midi",l.midiKey)}else{q.push(l)}}}}}function findPreset(a,b,e){for(var c=0;c<a.length;c++){var d=a[c];if(d.of("presetId").value==e&&d.of("bank").value==b){return d}}return null}function findSample(e,c){var a=c.of("samples").all("sample");for(var b=0;b<a.length;b++){var d=a[b];if(d.of("id").value==e){return d}}return null}function findInstrument(d,a){var b=a.of("soundfont").of("instruments").all("instrument");for(var c=0;c<b.length;c++){if(b[c].of("id").value==d){return b[c]}}return null}function fillInstruments(a,b,k,g){var d=k.of("zones").all("zone");var e=[];for(var f=0;f<d.length;f++){var h=d[f];var j=false;if(a>-1){for(var c=0;c<e.length;c++){if((1*e[c].of("keyRange").of("low").value>=1*h.of("keyRange").of("low").value&&1*e[c].of("keyRange").of("low").value<=1*h.of("keyRange").of("high").value)||(1*e[c].of("keyRange").of("high").value>=1*h.of("keyRange").of("low").value&&1*e[c].of("keyRange").of("high").value<=1*h.of("keyRange").of("high").value)||(1*e[c].of("keyRange").of("low").value<=1*h.of("keyRange").of("low").value&&1*e[c].of("keyRange").of("high").value>=1*h.of("keyRange").of("high").value)){j=true;break}}}if(!j){e.push(h);b.push({instrumentID:h.of("instrument").value,midi:a,keyRangeLow:1*h.of("keyRange").of("low").value,keyRangeHigh:1*h.of("keyRange").of("high").value})}}}function checkMIDISamples(){for(var c=0;c<128;c++){var b=false;for(var a=0;a<samplesForInstruments.length;a++){if(samplesForInstruments[a].midi==c){b=true;break}}if(!b){console.log("not found instrument",c)}}for(var c=34;c<81;c++){var b=false;for(var a=0;a<samplesForDrums.length;a++){if(samplesForDrums[a].midi==c){b=true;break}}if(!b){console.log("not found drum",c)}}}function resample2(c){var a=new Array(c.length);for(var b=0;b<c.length;b++){a[b]=1*c[b]}return a}var downSampleRatio=2.3;function resampleDown(e){var g=e.integers.length;var b=new OfflineAudioContext(1,g*downSampleRatio,10000*downSampleRatio);var c=b.createBuffer(1,g,10000);var a=c.getChannelData(0);for(var d=0;d<e.integers.length;d++){a[d]=e.integers[d]/(32768)}var f=b.createBufferSource();f.buffer=c;f.connect(b.destination);b.oncomplete=function(h){var m=h.renderedBuffer.getChannelData(0);var j=Math.round(m.length);e.integers2=new Array(j);var l=-1;for(var k=0;k<j;k++){if(m[k]!=0){l=k;break}}for(var k=0;k<j;k++){e.integers2[k]=Math.round(m[k+l]*32768)}console.log("resampleDown",e)};b.startRendering();f.start(0)};